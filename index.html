<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Carte Leaflet avec mise à jour de position</title>
    <link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css" />
    <script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>
    <script src="https://unpkg.com/leaflet-thunderforest/leaflet-thunderforest.js"></script>
    <style>
        #map {
            height: 100vh;
            width: 100%;
        }
    </style>
</head>
<body>

<div id="map"></div>

<script>
    // Initialisation de la carte, centrée sur Vitré (Ille-et-Vilaine, Bretagne)
    var map = L.map('map').setView([48.1167, -1.2192], 13); // Coordonnées de Vitré

    // Ajout des tuiles Thunderforest.Pioneer
    L.tileLayer('https://{s}.tile.thunderforest.com/pioneer/{z}/{x}/{y}.png?apikey=YOUR_API_KEY', {
        attribution: '&copy; <a href="https://www.thunderforest.com/">Thunderforest</a> contributors'
    }).addTo(map);

    // Position actuelle de l'utilisateur (mise à jour chaque seconde)
    var userMarker = L.marker([48.1167, -1.2192]).addTo(map); // Position initiale à Vitré
    var userCircle = L.circle([48.1167, -1.2192], {
        color: 'blue',
        fillColor: '#30f',
        fillOpacity: 0.5,
        radius: 200
    }).addTo(map);

    // Fonction pour obtenir la position actuelle de l'utilisateur
    function updateUserPosition() {
        navigator.geolocation.getCurrentPosition(function(position) {
            var lat = position.coords.latitude;
            var lon = position.coords.longitude;
            
            // Mise à jour du marqueur et du cercle
            userMarker.setLatLng([lat, lon]);
            userCircle.setLatLng([lat, lon]);
        });
    }

    // Mise à jour de la position toutes les secondes
    setInterval(updateUserPosition, 1000);

    // Cercle qui se rétrécit toutes les 5 secondes
    var circleRadius = 200;
    setInterval(function() {
        if (circleRadius > 50) {
            circleRadius -= 10;  // Réduction du rayon
            userCircle.setRadius(circleRadius);
        }
    }, 5000);
</script>

</body>
</html>
